None
loading_inputs
about to predict
CONFIG_FILE_NAME = save.yml
batch_size = 8
condition_file = None
debug = true
device = cuda
dropout = 0.1
embedding_dim = 256
epochs = 1000
event_dim = 388
experiment = embedding256-layer6
fp16 = None
l_r = 0.001
label_smooth = 0.1
length = 4000
load_path = None
max_seq = 2048
num_layers = 6
pad_token = 388
pickle_dir = ../MusicTransformer/dataset/processed
save_path = /home/usuaris/imatge/pau.lozano/tfg/PauTransformer/MusicTransformer-pytorch/generations/generated.mid
threshold_len = 500
token_eos = 390
token_sos = 389
vocab_size = 391
4000
generation finished:
24
28
31
265
156
252
190
262
165
310
381
76
124
159
180
122
257
152
388
256
156
204
380
55
204
204
295
375
47
277
156
175
256
159
313
375
47
256
175
379
48
291
370
72
260
374
40
183
307
373
35
381
288
149
378
38
376
40
355
247
376
59
216
246
256
168
156
155
376
76
15
375
313
380
80
321
123
380
262
168
299
375
71
314
172
235
381
355
60
298
168
381
43
287
166
323
149
159
263
332
312
375
76
259
379
72
285
159
263
375
59
335
302
379
59
377
83
256
377
67
286
386
28
256
375
68
322
72
375
110
159
379
40
306
378
346
380
174
377
294
380
71
284
329
370
59
256
371
31
256
381
59
257
376
69
378
40
377
69
322
168
329
168
308
165
373
221
166
172
378
326
379
67
328
388
197
380
78
257
176
377
79
256
376
71
256
375
75
268
376
88
355
33
263
176
200
294
378
82
377
30
266
156
168
355
355
303
204
378
72
321
376
76
312
204
376
71
321
379
105
274
379
47
355
284
168
150
312
168
344
379
309
374
120
377
31
267
168
282
379
64
355
355
355
338
379
68
288
152
380
95
278
263
377
74
279
379
76
376
76
333
379
51
355
355
355
36
317
176
373
88
302
374
69
265
162
299
377
260
373
234
265
113
371
133
8
346
380
74
256
377
69
273
373
168
376
67
355
343
371
41
256
236
376
69
142
139
380
51
268
375
72
355
350
374
59
274
376
120
33
297
187
71
355
268
168
188
199
378
71
355
275
187
199
373
57
355
318
183
310
378
71
315
372
57
260
157
378
68
355
331
376
75
355
256
381
388
377
75
285
156
377
69
90
256
375
69
272
199
373
51
309
25
256
373
74
355
261
373
69
249
375
75
349
163
373
60
355
302
176
285
171
204
257
204
376
33
266
376
153
380
51
276
371
223
265
376
83
256
375
64
257
373
68
261
375
67
256
41
354
377
40
257
168
301
361
52
355
261
374
35
355
312
196
378
83
263
378
52
286
372
216
321
369
62
374
81
316
375
72
261
380
78
263
377
51
378
64
355
296
380
92
371
78
356
88
355
355
304
271
376
66
38
260
379
52
73
353
380
100
299
197
378
289
370
66
352
159
262
187
288
376
233
172
105
355
312
371
47
355
317
377
78
258
187
262
197
199
378
69
355
355
355
297
376
40
302
375
32
376
362
59
314
375
96
355
239
10
376
38
267
211
380
33
304
373
45
373
77
259
166
165
159
377
52
257
156
375
47
147
199
382
91
257
377
40
355
276
375
66
291
161
379
48
261
380
100
256
368
45
256
208
372
49
167
180
370
49
257
376
87
256
378
33
285
23
355
282
369
27
256
376
66
256
381
90
245
372
81
267
379
79
264
376
57
130
379
35
280
187
374
14
378
45
156
376
336
380
78
336
378
62
292
196
372
35
347
199
19
49
266
214
374
60
342
145
379
72
257
375
87
376
30
309
372
33
102
355
353
375
71
379
47
256
263
203
378
66
272
379
50
344
368
33
171
375
81
372
40
256
377
72
355
280
373
88
257
228
376
66
307
209
374
93
259
366
52
333
221
377
311
378
35
259
169
365
59
375
61
277
175
346
378
31
372
93
295
179
380
118
370
38
354
371
140
376
85
291
366
233
373
88
328
369
40
305
381
59
149
377
68
355
355
259
373
38
316
365
72
355
355
355
286
168
372
39
325
332
378
38
326
372
84
166
373
95
54
343
357
83
305
167
190
364
33
175
375
38
355
321
377
28
300
373
39
336
282
167
379
37
163
378
27
377
59
258
351
367
35
256
135
355
256
379
44
257
175
370
75
355
301
206
376
35
256
173
368
39
355
71
306
373
39
258
176
373
383
97
46
296
376
90
389
152
378
98
355
256
380
280
220
377
38
355
355
285
167
379
41
273
215
369
26
351
367
23
355
355
355
355
209
374
66
329
180
162
375
37
257
177
228
378
273
297
368
31
256
370
43
116
372
38
324
227
168
373
28
175
161
322
379
73
257
209
367
34
355
336
161
369
70
355
258
211
381
278
211
375
31
355
269
164
380
81
304
199
369
134
32
256
199
376
27
355
323
367
29
312
370
37
256
182
375
56
222
24
222
109
380
168
368
104
355
309
167
371
39
308
368
206
378
87
311
376
47
355
258
354
194
378
72
312
168
365
26
333
371
36
177
367
33
256
161
375
30
355
273
168
370
59
381
96
277
373
27
337
365
26
331
201
161
377
70
368
22
317
377
37
256
75
355
277
175
372
40
351
376
53
353
188
378
211
372
39
355
321
168
368
39
257
131
161
91
327
372
58
256
376
39
207
373
27
379
23
323
160
374
39
256
156
370
33
173
365
28
374
87
341
369
39
270
376
66
284
373
36
336
373
76
257
366
38
355
302
372
39
355
379
27
311
199
380
317
366
32
161
372
37
257
13
230
372
40
355
273
370
29
153
373
86
256
175
232
373
57
355
166
376
34
66
237
377
87
368
68
161
32
199
374
27
355
371
28
154
374
32
337
167
376
34
380
80
256
161
373
45
256
231
377
26
248
40
263
229
375
181
155
381
82
270
373
246
377
387
27
161
364
5
155
370
201
161
371
63
167
371
32
320
225
386
158
374
63
279
377
38
362
164
374
166
375
167
177
187
34
369
40
377
35
355
372
168
380
92
258
194
166
368
45
379
39
256
367
31
256
159
374
32
306
165
382
78
316
152
377
79
256
367
34
187
335
155
156
368
32
269
154
248
160
367
41
378
63
374
32
315
156
373
34
371
92
306
165
90
160
241
156
380
32
256
378
87
257
155
375
14
375
27
261
160
166
372
39
355
256
155
369
32
376
68
379
31
378
22
379
92
257
158
374
39
372
368
27
160
374
160
227
368
34
373
22
371
88
157
366
38
375
155
377
68
165
380
41
256
155
372
39
371
100
376
59
256
152
377
34
374
31
298
191
162
374
35
152
378
34
375
330
207
374
39
313
369
44
257
150
374
39
167
369
54
295
372
30
372
34
376
72
347
155
374
63
371
33
335
162
372
32
347
374
34
318
160
371
44
331
155
374
34
162
371
27
172
162
379
27
299
371
27
20
256
162
182
162
374
32
256
112
365
24
268
370
23
314
119
162
162
231
378
34
375
32
297
377
46
373
35
356
30
355
355
334
366
39
375
34
312
162
374
75
164
162
162
365
39
214
352
160
147
376
153
368
34
344
155
380
39
308
167
373
34
256
156
162
375
27
295
368
86
164
371
39
373
28
339
160
377
66
164
370
34
321
237
371
63
256
155
374
31
341
162
372
371
35
160
162
1
257
162
162
167
375
32
162
369
34
172
373
39
315
162
217
379
39
296
374
73
372
15
162
160
167
373
26
160
162
167
40
355
282
156
367
34
285
162
375
32
369
34
355
290
160
377
82
370
32
355
259
162
379
89
372
34
307
379
74
372
44
162
371
162
376
34
372
37
370
55
258
162
369
34
263
374
32
160
369
63
355
355
259
162
368
162
366
34
256
364
355
266
162
368
46
256
196
244
162
367
240
367
39
162
369
183
162
373
38
242
368
27
257
160
370
39
312
172
162
364
29
162
371
32
371
35
371
34
377
32
256
162
369
34
162
168
167
370
92
297
162
369
51
277
163
313
168
162
376
33
300
162
370
63
167
370
34
365
34
373
80
215
371
36
374
87
168
250
34
305
160
367
34
258
160
364
38
256
191
256
365
33
377
58
315
162
373
31
162
372
35
314
160
367
34
381
70
232
376
30
340
160
269
376
162
162
373
323
179
167
87
261
372
162
370
34
174
172
371
37
369
33
372
68
271
373
67
367
34
270
369
35
256
379
34
291
162
369
32
280
252
162
370
275
378
34
167
372
39
343
371
32
162
371
34
370
34
162
162
156
372
34
162
371
39
162
368
32
112
370
39
167
369
68
344
377
80
256
369
34
334
191
174
374
133
162
373
42
371
376
39
162
371
156
368
67
369
34
256
370
329
167
376
51
327
189
298
162
375
314
162
162
371
34
284
203
323
202
160
369
45
372
34
167
369
39
167
101
256
167
369
162
72
315
167
374
33
162
366
68
376
385
86
313
357
160
325
198
373
39
294
201
190
71
307
172
371
34
354
191
373
155
137
167
372
39
162
371
38
344
160
374
46
162
229
4
208
160
371
34
372
39
296
174
256
327
372
304
162
14
372
22
370
63
291
155
370
62
256
370
32
167
366
34
347
376
63
265
369
157
368
32
281
167
158
320
163
162
181
372
44
314
148
371
32
374
38
381
74
355
162
367
64
311
160
355
371
75
257
162
295
161
167
160
299
372
50
369
46
109
161
372
31
372
209
97
355
259
370
38
355
368
39
273
162
372
46
261
62
256
159
371
161
173
198
173
368
38
355
163
368
32
259
162
363
324
160
174
162
166
368
32
298
162
171
12
367
62
355
355
0
371
78
314
365
41
375
156
374
269
370
70
355
273
176
257
162
366
32
314
160
372
34
256
162
160
283
369
236
369
32
291
160
374
264
368
35
280
162
373
86
365
67
311
179
371
34
162
368
36
256
162
369
34
301
162
367
35
169
166
376
53
372
32
256
307
191
377
82
260
162
366
36
355
308
167
366
307
222
355
263
162
367
43
256
367
51
264
164
369
79
319
160
167
366
36
376
84
258
369
39
257
371
34
256
372
39
368
38
292
161
375
72
368
34
270
162
364
142
179
162
370
32
162
356
33
256
162
161
162
373
55
238
332
162
369
38
145
364
32
293
162
370
38
334
182
191
191
113
364
38
302
191
195
372
75
355
275
368
369
42
259
191
162
116
367
34
256
165
197
169
240
256
186
162
375
70
342
371
196
266
172
162
371
39
371
34
258
162
368
39
274
369
61
355
355
275
162
35
256
370
77
257
195
162
371
70
270
84
280
370
34
262
162
370
31
279
368
124
162
371
62
160
157
166
162
368
34
355
58
260
160
290
368
34
268
167
369
31
354
122
256
162
365
33
256
369
30
256
340
374
51
309
182
191
271
164
257
160
160
368
34
370
34
355
273
203
257
365
26
70
312
166
257
370
39
273
367
31
369
31
256
371
79
374
70
296
169
160
256
368
44
306
371
75
307
167
302
375
84
339
369
46
263
372
78
269
372
34
256
371
61
355
369
34
259
174
343
174
166
258
372
70
256
298
370
72
294
366
34
278
166
370
79
260
166
195
258
160
267
162
371
63
355
274
374
74
34
261
22
266
163
369
39
274
171
341
174
309
367
34
303
172
364
32
283
160
279
271
370
74
267
368
20
267
369
63
359
38
372
71
282
174
262
162
259
174
369
43
320
374
79
297
372
44
364
38
372
70
279
160
294
160
291
110
368
34
27
256
30
370
31
322
99
355
271
160
314
366
31
305
376
79
272
371
27
339
370
224
355
263
164
355
258
363
312
372
47
371
38
282
372
81
283
160
161
161
295
372
31
318
367
39
275
160
274
35
258
366
35
250
106
304
164
351
370
311
369
113
277
372
70
288
47
370
39
287
374
70
289
375
41
370
75
266
198
373
36
257
253
355
294
167
367
38
372
74
278
172
160
162
322
366
32
129
369
43
274
372
73
265
370
43
326
371
24
356
72
297
172
368
34
355
289
369
32
42
355
269
162
374
34
258
373
33
276
207
370
77
261
366
43
162
373
39
261
373
34
363
32
257
167
360
34
315
162
363
79
340
149
369
39
288
370
26
309
371
32
333
371
39
262
369
31
256
373
70
326
368
34
291
153
376
84
292
376
34
261
367
34
275
167
370
82
256
371
325
171
167
369
72
264
308
175
376
75
370
34
198
375
82
315
373
70
293
172
368
55
268
366
32
260
210
297
370
39
313
371
41
306
166
371
34
355
283
374
40
367
29
320
166
366
34
266
371
72
273
162
182
376
70
306
198
370
75
374
44
300
374
22
293
368
39
289
202
364
47
298
373
44
263
369
32
275
167
366
86
368
39
269
373
70
256
373
75
355
259
368
195
364
32
265
369
162
371
36
369
32
289
107
274
162
368
24
375
39
291
370
32
370
162
367
46
295
158
366
57
343
371
77
283
372
84
266
162
368
45
256
367
35
259
172
8
259
162
76
256
198
113
162
369
36
341
191
371
62
167
371
29
289
371
59
256
370
29
262
162
369
77
267
165
365
41
361
67
375
34
232
375
39
369
31
150
371
34
352
367
278
162
374
81
287
371
32
37
290
191
369
75
256
166
367
29
263
370
152
369
34
294
160
369
46
162
369
41
271
162
369
40
292
162
160
374
84
150
369
264
372
74
355
292
167
367
213
375
82
367
70
279
10
286
371
89
256
132
291
367
77
265
370
36
372
34
373
75
271
171
369
238
299
373
74
369
97
275
368
48
355
284
159
364
32
160
376
27
293
368
51
284
369
47
304
365
47
266
371
72
267
167
369
31
282
183
358
32
233
202
368
69
271
167
371
38
307
161
367
58
257
155
373
38
159
365
32
256
174
370
39
256
355
275
371
34
160
372
73
349
157
65
167
371
32
287
155
322
162
367
39
266
373
46
258
162
372
70
369
65
300
368
38
283
369
34
382
85
169
372
77
257
370
84
304
372
87
310
188
372
62
355
355
266
160
365
34
160
371
30
308
369
33
283
160
369
34
296
370
34
167
369
38
372
87
370
37
279
374
86
260
371
36
281
375
32
266
378
70
331
168
370
31
324
160
370
81
246
222
365
31
258
160
370
94
170
365
50
338
161
371
34
256
163
369
60
162
366
44
258
169
370
39
166
373
32
260
162
322
160
371
36
291
160
365
34
212
160
372
48
287
166
368
34
162
370
34
162
160
157
373
34
256
162
222
174
370
53
160
369
39
261
168
181
326
163
367
34
268
365
31
355
369
34
162
371
74
341
160
369
34
281
205
368
38
296
364
36
355
256
157
174
368
31
261
370
31
307
369
32
371
197
369
32
304
198
371
29
257
174
365
56
309
198
375
32
318
370
330
340
372
86
263
212
379
86
377
74
304
375
67
156
367
38
256
172
366
39
310
164
367
58
299
164
370
88
161
267
160
366
34
348
173
372
86
370
11
173
121
301
164
371
84
258
386
41
294
186
160
370
32
324
56
282
273
377
41
286
368
39
292
369
33
257
370
71
367
35
256
157
368
214
371
60
257
174
373
72
244
162
208
371
212
162
370
72
297
157
162
371
71
256
157
370
38
329
215
369
31
217
373
34
355
306
162
370
32
279
368
46
355
366
41
162
368
30
305
220
291
371
36
350
174
369
36
251
355
373
58
328
366
40
369
34
257
172
372
34
162
370
38
346
162
372
33
372
272
162
377
198
370
35
271
174
25
269
164
366
32
162
369
163
369
33
371
162
162
365
36
321
211
357
45
259
162
370
33
305
12
161
342
372
30
368
37
341
153
374
53
257
162
33
289
166
374
385
84
218
57
162
370
27
264
161
106
367
39
293
162
373
34
372
70
304
170
374
89
162
375
63
258
370
101
265
373
27
166
370
31
355
269
162
370
39
341
372
194
374
46
337
374
56
355
256
370
283
368
46
256
194
160
375
84
373
36
96
371
251
362
34
372
33
265
374
87
371
32
159
369
35
266
367
38
257
59
376
41
297
367
32
257
162
269
162
376
62
331
374
162
373
56
257
160
374
32
162
371
202
166
364
38
325
365
32
364
33
257
162
16
167
366
33
370
46
166
367
37
166
377
96
162
368
38
268
96
368
49
370
31
372
32
277
172
371
37
291
164
374
33
374
30
214
373
35
355
297
162
374
21
90
161
367
34
22
256
165
371
36
257
366
57
266
159
159
375
248
162
374
34
329
217
374
46
369
32
368
39
24
284
159
369
130
167
366
38
162
372
37
164
379
44
258
159
371
159
372
32
161
370
161
369
333
366
34
269
370
34
258
372
37
371
37
276
372
58
369
37
273
163
256
160
376
34
276
372
32
266
368
46
256
370
160
160
373
89
378
34
259
366
378
26
258
159
368
39
160
368
157
371
32
256
174
163
65
355
256
160
374
32
159
363
34
375
148
164
374
37
370
34
373
161
355
270
160
372
34
301
160
160
369
27
283
160
160
372
40
256
145
369
283
188
161
370
44
318
374
34
256
301
377
80
299
168
368
102
257
168
379
74
312
372
36
306
160
370
40
283
378
285
160
365
36
314
161
373
32
256
147
159
366
44
160
372
46
265
167
373
26
257
369
34
256
174
370
32
331
373
36
308
375
32
75
167
374
32
257
371
32
377
39
305
369
31
306
368
34
369
40
365
32
256
186
374
160
368
36
319
162
371
87
256
163
376
34
160
376
82
377
379
76
372
35
335
160
167
371
160
174
162
158
365
40
256
244
160
370
34
317
158
366
20
162
126
160
370
32
321
368
32
162
370
44
164
16
159
374
36
256
160
368
31
323
336
4
160
355
296
174
362
33
165
373
38
370
37
372
37
369
34
307
160
371
34
256
376
34
383
87
344
174
379
98
355
271
375
39
138
85
160
372
33
373
39
370
163
373
46
160
369
55
257
157
375
34
349
166
375
33
370
310
160
369
34
257
174
372
25
369
44
10
371
38
353
167
327
162
369
34
256
160
372
34
180
271
160
367
35
305
165
363
32
292
160
370
35
106
257
174
167
369
266
375
87
376
32
36
285
160
155
374
32
256
157
160
293
167
370
33
104
160
374
31
306
160
366
160
371
34
256
184
165
369
33
160
375
34
371
31
167
377
82
319
174
160
371
32
314
197
288
161
164
375
33
355
120
32
349
182
372
34
319
162
150
372
31
162
375
37
90
368
33
172
162
368
32
369
32
310
160
378
32
373
30
376
85
256
162
155
162
370
35
166
368
32
262
373
33
371
35
256
162
162
374
158
367
73
306
376
34
352
162
162
367
162
373
34
355
370
74
285
373
39
162
368
31
164
368
72
307
162
363
38
302
375
247
165
368
32
52
368
39
166
166
368
27
369
75
296
162
370
36
355
355
355
189
162
370
32
172
371
32
368
21
355
160
162
162
368
32
257
174
162
162
373
32
162
372
32
165
162
162
369
34
376
72
303
374
162
162
372
info removed pitch: 124
info removed pitch: 62
info removed pitch: 37
info removed pitch: 52
info removed pitch: 21
info removed pitch: 119
info removed pitch: 88
info removed pitch: 118
info removed pitch: 27
info removed pitch: 44
info removed pitch: 107
info removed pitch: 21
info removed pitch: 46
info removed pitch: 37
info removed pitch: 93
info removed pitch: 44
info removed pitch: 22
info removed pitch: 34
info removed pitch: 106
info removed pitch: 5
info removed pitch: 108
info removed pitch: 14
info removed pitch: 11
info removed pitch: 29
info removed pitch: 121
info removed pitch: 44
info removed pitch: 111
info removed pitch: 37
info removed pitch: 19
info removed pitch: 39
info removed pitch: 117
info removed pitch: 2
info removed pitch: 86
info removed pitch: 17
info removed pitch: 12
info removed pitch: 21
info removed pitch: 7
info removed pitch: 34
info removed pitch: 99
info removed pitch: 6
info removed pitch: 94
info removed pitch: 94
info removed pitch: 3
info removed pitch: 103
info removed pitch: 101
info removed pitch: 99
info removed pitch: 103
info removed pitch: 89
info removed pitch: 114
info removed pitch: 9
info removed pitch: 108
info removed pitch: 94
info removed pitch: 17
info removed pitch: 125
info removed pitch: 21
info removed pitch: 94
info removed pitch: 2
info removed pitch: 17
